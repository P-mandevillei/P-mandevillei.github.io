import{u as X,r as a,j as e,A as P,m as L,T as V,c as M,a as Z,C as ee,L as q}from"./index-DqVyQ7DI.js";import{u as D,C as re}from"./chevron-down-BoDWhT1O.js";import{T as ne}from"./TimeStamp-BcR1rfhg.js";import{C as se}from"./Card-m-SWVjZ-.js";import{B as R,F as m}from"./Form-6c-IEpLl.js";import{R as te}from"./Row-MoJ4XHs1.js";import{C as H}from"./Col-B4HiK5qo.js";function ae(c,r,u,d,i){const n=typeof c=="number"&&c>=0,x=typeof r=="number"&&r>=0,g=typeof u=="number"&&u>=0,v=typeof d=="number"&&d>=0,f=n+x+g+v;if(f===4)return{error:!0,msg:"noUnknown"};if(f<=2)return{error:!0,msg:"incomplete"};if(v)if(n)if(x){if(g)return{error:!0,msg:"invalid"};{if(d===0)return{error:!0,msg:"reminder"};let s=d/100;if(i!=="removeThenAdd")if(i==="removeWhileAdd")s=1-1/Math.pow(Math.E,s);else if(i==="addThenRemove")s=s/(1+s);else return{error:!0,msg:"invalid"};const o=r*(1-s)+c*s;return o>=0?{error:!1,unknown:"m",value:o.toFixed(2)}:{error:!0,msg:"reminder"}}}else{let s=d/100;if(i!=="removeThenAdd")if(i==="removeWhileAdd")s=1-1/Math.pow(Math.E,s);else if(i==="addThenRemove")s=s/(1+s);else return{error:!0,msg:"invalid"};return s===1?{error:!1,unknown:"x",value:c}:{error:!1,unknown:"x",value:((u-c*s)/(1-s)).toFixed(2)}}else{if(d===0)return{error:!0,msg:"reminder"};let s=d/100;if(i!=="removeThenAdd")if(i==="removeWhileAdd")s=1-1/Math.pow(Math.E,s);else if(i==="addThenRemove")s=s/(1+s);else return{error:!0,msg:"invalid"};const o=(u-r)/s+r;return o>=0?{error:!1,unknown:"s",value:o.toFixed(2)}:{error:!0,msg:"impossible"}}else{const s=c-r;if(s==0)return{error:!0,msg:"impossible"};const o=(u-r)/s;return o<0||o>=1?{error:!0,msg:"impossible"}:i==="removeThenAdd"?{error:!1,unknown:"y",value:(o*100).toFixed(2)}:i==="removeWhileAdd"?{error:!1,unknown:"y",value:(Math.log(1/(1-o))*100).toFixed(2)}:i==="addThenRemove"?{error:!1,unknown:"y",value:(o/(1-o)*100).toFixed(2)}:{error:!0,msg:"invalid"}}}function le(c){const{t:r}=X("waterChangeLevelAdjustment"),u=`levelAdj${c.name}`,d=a.useId(),i=a.useId(),n=a.useId(),x=a.useId(),g=a.useId(),v=a.useId(),f=a.useRef(),s=a.useRef(),[o,S]=a.useState({error:!0,msg:r("incomplete")}),[t,T]=D(u,{substance:r("name"),unit:r("unit"),s:null,x:null,m:null,y:null});a.useEffect(()=>{j.current.value=t.s,y.current.value=t.x,C.current.value=t.m,b.current.value=t.y,N()},[]),a.useEffect(()=>{$()},[c.mode]);let p={...t};a.useEffect(()=>{p={...t}},[t]);const[z,E]=a.useState(!1),[G,W]=a.useState(!1),j=a.useRef(),y=a.useRef(),C=a.useRef(),b=a.useRef(),A={s:{name:r("s",{name:t.substance}),unit:t.unit,id:n,ref:j},x:{name:r("x",{name:t.substance}),unit:t.unit,id:x,ref:y},m:{name:r("m",{name:t.substance}),unit:t.unit,id:g,ref:C},y:{name:r("y"),unit:"%",id:v,ref:b}};function $(){var l,h,F,B;p.s=(l=j.current)==null?void 0:l.value,p.x=(h=y.current)==null?void 0:h.value,p.m=(F=C.current)==null?void 0:F.value,p.y=(B=b.current)==null?void 0:B.value,T(p),S(ae(parseFloat(j.current.value),parseFloat(y.current.value),parseFloat(C.current.value),parseFloat(b.current.value),c.mode))}const[k,w]=a.useState("");function N(){const l=parseFloat(j.current.value),h=parseFloat(y.current.value),F=parseFloat(C.current.value),B=parseFloat(b.current.value),K=typeof l=="number"&&l>=0,Y=typeof h=="number"&&h>=0,_=typeof F=="number"&&F>=0,Q=typeof B=="number"&&B>=0;if(K+Y+_+Q<3){w("");return}if(K)if(Y)if(_){w("y");return}else{w("m");return}else{w("x");return}else{w("s");return}}function J(){I(!0)}function O(){I(!1),localStorage.removeItem(u);const l=c.blockNum.filter(h=>h!=c.name);c.setBlockNum(l)}const[U,I]=a.useState(!1);return e.jsxs(se,{className:"pad",style:{position:"relative"},children:[e.jsx(P,{children:U&&e.jsx(L.div,{className:"backdrop",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.5}})}),e.jsx("span",{style:{position:"absolute",top:"1%",right:"2%"},className:"tertiaryColor tertiaryColorHover selectableHover",onClick:J,children:"✘"}),e.jsx(V,{className:"p-3",position:"middle-center",children:e.jsxs(M,{className:"secondaryColor tertiaryColorReverseBg",show:U,onClose:()=>{I(l=>!l)},children:[e.jsx(M.Header,{children:e.jsxs("strong",{className:"me-auto",children:[r("deleteThis")," "]})}),e.jsxs(M.Body,{style:{display:"flex",flexDirection:"column"},children:[r("sure"),e.jsx(R,{className:"secondaryColorBg secondaryColorBgHover largeBtnEffect",style:{margin:10},onClick:()=>I(!1),children:r("cancel")}),e.jsx("span",{className:"emphasis emphasisHover selectable",onClick:O,children:r("delete")})]})]})}),e.jsxs("p",{className:"center bold enlarge primaryColor",children:[e.jsx("span",{className:"selectable primaryColorHover",onClick:()=>{E(l=>!l),W(!1)},children:t.substance}),"  ",e.jsxs("span",{className:"selectable primaryColorHover",onClick:()=>{W(l=>!l),E(!1)},children:["(",t.unit,")"]}),z?e.jsxs(e.Fragment,{children:[e.jsx(m.Label,{htmlFor:d}),e.jsx(m.Control,{id:d,ref:f,placeholder:r("newName")}),e.jsx(R,{className:"cardBtn primaryColorBg primaryColorBgHover",onClick:l=>{var h;l==null||l.preventDefault(),p.substance=(h=f.current)==null?void 0:h.value,T(p)},children:r("updateName")})]}):e.jsx(e.Fragment,{}),G?e.jsxs(e.Fragment,{children:[e.jsx(m.Label,{htmlFor:i}),e.jsx(m.Control,{id:i,ref:s,placeholder:r("newUnit")}),e.jsx(R,{className:"cardBtn primaryColorBg primaryColorBgHover",onClick:l=>{var h;l==null||l.preventDefault(),p.unit=(h=s.current)==null?void 0:h.value,T(p)},children:r("updateUnit")})]}):e.jsx(e.Fragment,{})]}),e.jsxs(m.Label,{htmlFor:n,children:[r("s",{name:t.substance}),": ",t.unit?`(${t.unit})`:""]}),e.jsx(m.Control,{type:"number",id:n,ref:j,onChange:N,disabled:k==="s"}),e.jsxs(m.Label,{htmlFor:x,children:[r("x",{name:t.substance}),": ",t.unit?`(${t.unit})`:""]}),e.jsx(m.Control,{type:"number",id:x,ref:y,onChange:N,disabled:k==="x"}),e.jsxs(m.Label,{htmlFor:g,children:[r("m",{name:t.substance}),": ",t.unit?`(${t.unit})`:""]}),e.jsx(m.Control,{type:"number",id:g,ref:C,onChange:N,disabled:k==="m"}),e.jsxs(m.Label,{htmlFor:v,children:[r("y")," (%)"]}),e.jsx(m.Control,{type:"number",id:v,ref:b,onChange:N,disabled:k==="y"}),e.jsx("br",{}),e.jsx(R,{className:"primaryColorBg primaryColorBgHover largeBtnEffect",onClick:$,disabled:k==="",children:r("calc")}),e.jsx("p",{className:"secondaryColor bold",children:o.error?r(o.msg):e.jsxs(e.Fragment,{children:[A[o.unknown].name,": ",o.value," ",A[o.unknown].unit?`(${A[o.unknown].unit})`:""]})})]})}function pe(){const[c,r]=D("mode","default"),[u,d]=D("levelBlocks",[0]),i=a.useId(),{t:n}=X("waterChangeLevelAdjustment"),{lang:x}=Z(),[g,v]=a.useState(!1);return e.jsxs("div",{style:{position:"relative",minHeight:"90vh"},className:"pad",children:[e.jsx(ee,{fluid:!0,style:{width:"100%",marginBottom:"2em"},children:e.jsxs(te,{children:[e.jsxs(H,{xs:12,sm:6,lg:4,xl:3,children:[e.jsxs("p",{className:"primaryColor bold enlarge center noMargin",children:[n("title")," ",e.jsx("sup",{children:"*"})," "]}),e.jsxs("p",{className:"noMargin grey bold selectableHover hover",onClick:()=>{v(f=>!f)},children:[e.jsx(L.span,{animate:{rotate:g?0:-90},transition:{duration:.2},style:{display:"inline-block"},children:e.jsx(re,{size:18})}),n("ins")]}),e.jsx(P,{children:g&&e.jsxs(L.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},transition:{duration:.5},exit:{opacity:0,height:0},children:[e.jsxs("p",{className:"shrink primaryColor",children:[n("nav1"),e.jsx(q,{to:`/${x}/aquarium_calculator/water_change_calculator`,children:n("nav2")})]}),e.jsxs("p",{className:"noMargin",children:[n("des1"),e.jsx("span",{className:"primaryColor bold",children:"+"}),n("des2")]}),e.jsxs("p",{className:"noMargin",children:[e.jsx("span",{className:"primaryColor bold",children:n("des3")}),n("des4"),e.jsx("span",{className:"primaryColor bold",children:n("des5")}),n("des6")]}),e.jsxs("p",{children:[n("des7"),e.jsx("span",{className:"primaryColor bold",children:n("des8")}),n("des9")]}),e.jsxs("p",{className:"grey shrink",children:[" ",n("unitReminder")," "]})]})}),e.jsxs("p",{className:"center marginTopBottom",children:[e.jsx(m.Label,{htmlFor:i,className:"primaryColor",children:n("modeSelect")}),e.jsxs(m.Select,{id:i,value:c,onChange:f=>r(f.target.value),children:[e.jsxs("option",{value:"default",children:["-- ",n("default")," --"]}),e.jsx("option",{value:"removeThenAdd",children:n("mode1")}),e.jsx("option",{value:"removeWhileAdd",children:n("mode2")}),e.jsx("option",{value:"addThenRemove",children:n("mode3")})]})]}),e.jsxs("p",{className:"shrink grey",children:[e.jsx("sup",{children:"*"})," ",n("reference")," ",e.jsxs("a",{href:"https://mp.weixin.qq.com/s/1Hr0FKTt7gGaDrpPCIKldw",target:"_blank",children:[" ",n("refTitle")," "]})]})]}),u.map(f=>e.jsx(H,{xs:12,sm:6,lg:4,xl:3,style:{padding:0},children:e.jsx(le,{mode:c,name:f,blockNum:u,setBlockNum:d})},f)),e.jsx(H,{xs:12,sm:6,lg:4,xl:3,className:"pad",style:{height:450,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(R,{className:"round primaryColorBg primaryColorBgHover",style:{aspectRatio:"1/1",margin:"auto"},onClick:()=>{u.length>0?d([...u,u[u.length-1]+1]):d([0])},children:"+"})})]})}),e.jsxs("div",{style:{position:"absolute",bottom:0},children:[e.jsx(q,{to:`/${x}/aquarium_calculator`,children:n("back")}),e.jsx(ne,{name:"waterChangeLevelAdjustment"})]})]})}export{pe as default};
