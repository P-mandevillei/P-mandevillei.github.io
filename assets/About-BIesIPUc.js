import{d as R,e as S,r as s,f as k,u as L,g as E,j as n,T as H,c as B,l as z,h as A,a as J,i as V}from"./index-DqVyQ7DI.js";import{B as I,F as C}from"./Form-6c-IEpLl.js";import{C as $}from"./Card-m-SWVjZ-.js";import"./Col-B4HiK5qo.js";var w=function(){return w=Object.assign||function(e){for(var t,a=1,o=arguments.length;a<o;a++){t=arguments[a];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},w.apply(this,arguments)},q=function(e,t){var a={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,o=Object.getOwnPropertySymbols(e);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(e,o[r])&&(a[o[r]]=e[o[r]]);return a},D=k("BarLoader","0% {left: -35%;right: 100%} 60% {left: 100%;right: -90%} 100% {left: 100%;right: -90%}","long"),G=k("BarLoader","0% {left: -200%;right: 100%} 60% {left: 107%;right: -8%} 100% {left: 107%;right: -8%}","short");function P(e){var t=e.loading,a=t===void 0?!0:t,o=e.color,r=o===void 0?"#000000":o,d=e.speedMultiplier,g=d===void 0?1:d,i=e.cssOverride,f=i===void 0?{}:i,O=e.height,h=O===void 0?4:O,m=e.width,u=m===void 0?100:m,x=q(e,["loading","color","speedMultiplier","cssOverride","height","width"]),y=w({display:"inherit",position:"relative",width:S(u),height:S(h),overflow:"hidden",backgroundColor:R(r,.2),backgroundClip:"padding-box"},f),v=function(l){return{position:"absolute",height:S(h),overflow:"hidden",backgroundColor:r,backgroundClip:"padding-box",display:"block",borderRadius:2,willChange:"left, right",animationFillMode:"forwards",animation:"".concat(l===1?D:G," ").concat(2.1/g,"s ").concat(l===2?"".concat(1.15/g,"s"):""," ").concat(l===1?"cubic-bezier(0.65, 0.815, 0.735, 0.395)":"cubic-bezier(0.165, 0.84, 0.44, 1)"," infinite")}};return a?s.createElement("span",w({style:y},x),s.createElement("span",{style:v(1)}),s.createElement("span",{style:v(2)})):null}function K(e){const{t}=L("login"),{t:a}=L("backend"),o=s.useId(),r=s.useRef(),d=s.useId(),g=s.useRef(),[i,f,O,h]=s.useContext(E),[m,u]=s.useState(h===null),[x,y]=s.useState(!1),[v,l]=s.useState(!1),[N,b]=s.useState(""),[F,j]=s.useState("");s.useEffect(()=>{u(h===null)},[h]);function M(){u(!0);const p=r.current.value,_=g.current.value;fetch(z,{headers:{"content-type":"application/json"},credentials:"include",method:"POST",body:JSON.stringify({username:p,password:_})}).then(c=>c.json()).then(c=>{u(!1),c.error?(f(!1),b(t("fail")),j(a(c==null?void 0:c.msg)),l(!0)):c.login?f(!0):(f(!1),b(t("fail")),j(t("cannotFind")),l(!0))}).catch(c=>{u(!1),b(t("fail")),j(t("cannotConnect")),l(!0)})}function T(){y(!0),fetch(A,{headers:{"content-type":"application/json"},method:"POST",credentials:"include"}).then(p=>p.json()).then(p=>{y(!1),p.error?(b(t("logoutFail")),j(t("cannotConnect")),l(!0)):f(!1)}).catch(p=>{y(!1),b(t("logoutFail")),j(t("cannotConnect")),l(!0)})}return n.jsxs("div",{children:[n.jsx(H,{className:"p-3",position:"middle-center",style:{zIndex:998},children:n.jsxs(B,{className:"tertiaryColorBg",show:v,onClose:()=>{l(!1)},children:[n.jsx(B.Header,{children:n.jsx("span",{style:{flex:1},children:N})}),n.jsx(B.Body,{children:F})]})}),i?n.jsx(I,{className:`${e.logoutClassName} primaryColorBg primaryColorBgHover largeBtnEffect`,style:{...e==null?void 0:e.logoutStyle,display:"flex",justifyContent:"center",alignItems:"center"},onClick:T,children:x?n.jsx(P,{loading:x,color:"rgb(228, 193, 153)",cssOverride:{margin:"0.6em"}}):t("logout")}):n.jsxs($,{className:e.loginClassName,style:e==null?void 0:e.loginStyle,children:[n.jsxs("div",{className:"center enlarge bold primaryColor",children:[" ",t("title")," "]}),n.jsx(C.Label,{htmlFor:o,children:t("username")}),n.jsx(C.Control,{id:o,ref:r}),n.jsx(C.Label,{htmlFor:d,children:t("password")}),n.jsx(C.Control,{type:"password",id:d,ref:g}),n.jsx("br",{}),n.jsx(I,{onClick:M,disabled:m,className:"primaryColorBg primaryColorBgHover largeBtnEffect",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:m?n.jsx(P,{loading:m,color:"rgb(228, 193, 153)",cssOverride:{margin:"0.6em"}}):t("login")})]})]})}function Z(){const[e,t,a]=s.useContext(E),[o,r]=s.useState(""),{lang:d}=J();function g(){fetch(V,{method:"POST",credentials:"include",headers:{"content-type":"application/json"}}).then(i=>i.json()).then(i=>{i.error||(console.log(i),r(i.content))}).catch(i=>console.log(i))}return s.useEffect(()=>{e&&g()},[e]),n.jsxs("div",{children:[n.jsx(K,{loginClassName:"pad",logoutStyle:{position:"absolute",right:0,fontSize:"0.8em",padding:"0.4em"}}),e?n.jsx(n.Fragment,{children:o[d]}):""]})}export{Z as default};
